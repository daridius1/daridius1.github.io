---
import { getCollection } from "astro:content";
import "../../styles/global.css";
import heroImg from "../../assets/bg.png"; // Usamos el mismo fondo
import BlogFilter from "../../components/BlogFilter.jsx";

// 1. Obtener todos los posts
const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

// 2. Extraer todos los tags únicos para el filtro
const allTags = [...new Set(posts.flatMap((post) => post.data.tags))].sort();
---

<html lang="es">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>Blog Archivo | daridius</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap"
            rel="stylesheet"
        />
    </head>
    <body class="min-h-screen bg-transparent text-white antialiased">
        <!-- Background Image Fijo -->
        <div class="fixed inset-0 z-[-1]">
            <div
                class="absolute inset-0 bg-cover bg-center"
                style={`background-image: url(${heroImg.src});`}
            >
            </div>
            <div class="absolute inset-0 bg-black/50"></div>
        </div>

        <!-- Navbar -->
        <nav
            class="navbar bg-black/80 backdrop-blur-md border-b border-white/5 px-8 flex justify-between items-center z-50 sticky top-0"
        >
            <a
                href="/"
                class="text-xl font-black tracking-tighter capitalize hover:text-white/80 transition-colors"
            >
                daridius
            </a>
            <div class="flex gap-4">
                <a
                    href="/blog"
                    class="text-sm font-bold uppercase tracking-widest text-primary border-b-2 border-primary pb-1"
                >
                    Blog
                </a>
            </div>
        </nav>

        <main class="w-full max-w-6xl mx-auto px-6 py-12">
            <!-- React Component para filtrado dinámico -->
            <BlogFilter client:load posts={posts} allTags={allTags} />
        </main>
    </body>
</html>
